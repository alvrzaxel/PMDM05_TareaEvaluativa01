"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[2806],{2806:(E,h,n)=>{n.r(h),n.d(h,{VoicePageModule:()=>T});var d=n(177),S=n(4341),l=n(4742),p=n(7291),m=n(7464);const R=(0,m.F3)("Share",{web:()=>n.e(1227).then(n.bind(n,1227)).then(o=>new o.ShareWeb)});var e=n(4020),f=n(467);const s=(0,m.F3)("SpeechRecognition",{web:()=>n.e(6852).then(n.bind(n,6852)).then(o=>new o.SpeechRecognitionWeb)});var g=n(7691);let V=(()=>{var o;class r{constructor(){this.latestPhotoUrl="",this.isProcessing=!1}startRecognition(){var t=this;return(0,f.A)(function*(){try{if(console.log("Checking permissions..."),!(yield s.checkPermissions()).speechRecognition&&(console.log("Requesting permissions..."),!(yield s.requestPermissions()).speechRecognition))return void console.error("Speech recognition permission denied");console.log("Starting speech recognition...");const P=yield s.start({language:"es-ES",maxResults:2,partialResults:!0});console.log("Speech recognition started",P),s.addListener("partialResults",a=>{if(console.log("Partial results received:",a),!t.isProcessing)if(a.matches&&Array.isArray(a.matches)){var u;const v=(null===(u=a.matches[0])||void 0===u?void 0:u.toString().toLowerCase())||"";console.log("Transcribed text:",v),"foto"===v&&(t.isProcessing=!0,s.stop(),t.capturePhoto())}else console.log("No valid speech detected.")})}catch(i){console.error("Error starting recognition:",i)}})()}capturePhoto(){var t=this;return(0,f.A)(function*(){try{const i=yield g.i7.getPhoto({resultType:g.LK.Uri,source:g.ru.Camera,quality:100});t.latestPhotoUrl=i.webPath?i.webPath:"",console.log("Foto capturada, webPath:",t.latestPhotoUrl)}catch(i){console.error("Error al capturar la foto:",i)}})()}clearPhoto(){console.log("Foto eliminada"),this.latestPhotoUrl=""}}return(o=r).\u0275fac=function(t){return new(t||o)},o.\u0275prov=e.jDH({token:o,factory:o.\u0275fac,providedIn:"root"}),r})();var y=n(1265);function I(o,r){if(1&o){const c=e.RV6();e.j41(0,"ion-card",4),e.nrm(1,"img",5),e.j41(2,"ion-button",6),e.bIt("click",function(){e.eBV(c);const i=e.XpG();return e.Njj(i.onShareImage())}),e.EFF(3," Compartir foto "),e.k0s()()}if(2&o){const c=e.XpG();e.R7$(),e.Y8G("src",c.recognitionService.latestPhotoUrl,e.B4B)}}const C=[{path:"",component:(()=>{var o;class r{constructor(t){this.recognitionService=t}ngOnInit(){this.recognitionService.clearPhoto()}onShareImage(){const t=this.recognitionService.latestPhotoUrl;t?R.share({title:"Mira esta foto",text:"Te comparto una foto: ",url:t,dialogTitle:"Compartir foto"}).then(()=>{console.log("La foto ha sido compartida")}).catch(i=>{console.error("Error al compartir la foto",i)}):console.log("No hay foto para compartir")}}return(o=r).\u0275fac=function(t){return new(t||o)(e.rXU(V))},o.\u0275cmp=e.VBU({type:o,selectors:[["app-voice"]],standalone:!1,decls:5,vars:2,consts:[["titulo","Voz"],[3,"fullscreen"],["expand","block","fill","clear","shape","round",3,"click"],["class","photo-card",4,"ngIf"],[1,"photo-card"],["alt","\xdaltima foto tomada",1,"card-image",3,"src"],["expand","block",1,"card-button",3,"click"]],template:function(t,i){1&t&&(e.nrm(0,"app-page-header",0),e.j41(1,"ion-content",1)(2,"ion-button",2),e.bIt("click",function(){return i.recognitionService.startRecognition()}),e.EFF(3," INICIAR RECONOCIMIENTO DE VOZ "),e.k0s(),e.DNE(4,I,4,1,"ion-card",3),e.k0s()),2&t&&(e.R7$(),e.Y8G("fullscreen",!0),e.R7$(3),e.Y8G("ngIf",i.recognitionService.latestPhotoUrl))},dependencies:[d.bT,l.Jm,l.b_,l.W9,y.y],encapsulation:2}),r})()}];let F=(()=>{var o;class r{}return(o=r).\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.$C({type:o}),o.\u0275inj=e.G2t({imports:[p.iI.forChild(C),p.iI]}),r})();var M=n(8406);let T=(()=>{var o;class r{}return(o=r).\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.$C({type:o}),o.\u0275inj=e.G2t({imports:[d.MD,S.YN,l.bv,M.$,F]}),r})()}}]);